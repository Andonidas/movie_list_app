{"ast":null,"code":"import ACTION_TYPES from \"./actionTypes\";\nimport STATUS_TYPE from \"../reducers/statusTypes\";\nimport fetchTopRatedPage from \"../api/fetchTopRatedPage\"; // tell store the fetch has started\n\nconst startFetchPage = pageNumber => ({\n  type: ACTION_TYPES.topRatedPage.cachePageStart,\n  payload: pageNumber\n}); // tell store the fetch has failed\n\n\nconst failedFetchPage = pageNumber => ({\n  type: ACTION_TYPES.topRatedPage.cachePageFailed,\n  payload: pageNumber\n}); // let the store save the fetched data\n\n\nconst cachePage = data => ({\n  type: ACTION_TYPES.topRatedPage.cachePageSuccess,\n  payload: data\n}); // this step is async, so we should return a thunk function\n// for react-thunk middleware to handle\n\n\nconst fetchSaveTopRatedPage = pageNumber => (dispatch, getState) => {\n  const page = getState().topRatedPage.cachedPages[pageNumber];\n\n  if (page && page.status === STATUS_TYPE.start) {\n    // console.log(`fetch for page ${pageNumber} is in progress`);\n    return;\n  }\n\n  if (page && page.status === STATUS_TYPE.success) {\n    // console.log(`page ${pageNumber} is cahed`);\n    return;\n  }\n\n  dispatch(startFetchPage(pageNumber)); // fetch started\n\n  fetchTopRatedPage(pageNumber).then(response => dispatch(cachePage(response.data))) // fetch sucess, cache data\n  .catch(error => {\n    console.log(error);\n    dispatch(failedFetchPage(pageNumber)); // fetch failed\n  });\n};\n\nexport { fetchSaveTopRatedPage };","map":{"version":3,"names":["ACTION_TYPES","STATUS_TYPE","fetchTopRatedPage","startFetchPage","pageNumber","type","topRatedPage","cachePageStart","payload","failedFetchPage","cachePageFailed","cachePage","data","cachePageSuccess","fetchSaveTopRatedPage","dispatch","getState","page","cachedPages","status","start","success","then","response","catch","error","console","log"],"sources":["/Users/qiluan/Desktop/scripts/training/last_project/movie_list_app/movie_list/src/actionCreators/topRatedPageActionCreator.js"],"sourcesContent":["import ACTION_TYPES from \"./actionTypes\";\nimport STATUS_TYPE from \"../reducers/statusTypes\";\nimport fetchTopRatedPage from \"../api/fetchTopRatedPage\";\n\n// tell store the fetch has started\nconst startFetchPage = (pageNumber) => ({\n  type: ACTION_TYPES.topRatedPage.cachePageStart,\n  payload: pageNumber,\n});\n\n// tell store the fetch has failed\nconst failedFetchPage = (pageNumber) => ({ \n  type: ACTION_TYPES.topRatedPage.cachePageFailed,\n  payload: pageNumber,\n});\n\n// let the store save the fetched data\nconst cachePage = (data) => ({\n  type: ACTION_TYPES.topRatedPage.cachePageSuccess,\n  payload: data,\n});\n\n// this step is async, so we should return a thunk function\n// for react-thunk middleware to handle\nconst fetchSaveTopRatedPage = (pageNumber) => (dispatch, getState) => {\n  const page = getState().topRatedPage.cachedPages[pageNumber];\n  if (page && page.status === STATUS_TYPE.start) {\n    // console.log(`fetch for page ${pageNumber} is in progress`);\n    return;\n  }\n\n  if (page && page.status === STATUS_TYPE.success) {\n    // console.log(`page ${pageNumber} is cahed`);\n    return;\n  }\n\n  dispatch(startFetchPage(pageNumber)); // fetch started\n  fetchTopRatedPage(pageNumber)\n    .then(response => dispatch(cachePage(response.data))) // fetch sucess, cache data\n    .catch(error => {\n      console.log(error);\n      dispatch(failedFetchPage(pageNumber)); // fetch failed\n    })\n}\n\n\nexport { fetchSaveTopRatedPage };"],"mappings":"AAAA,OAAOA,YAAP,MAAyB,eAAzB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,OAAOC,iBAAP,MAA8B,0BAA9B,C,CAEA;;AACA,MAAMC,cAAc,GAAIC,UAAD,KAAiB;EACtCC,IAAI,EAAEL,YAAY,CAACM,YAAb,CAA0BC,cADM;EAEtCC,OAAO,EAAEJ;AAF6B,CAAjB,CAAvB,C,CAKA;;;AACA,MAAMK,eAAe,GAAIL,UAAD,KAAiB;EACvCC,IAAI,EAAEL,YAAY,CAACM,YAAb,CAA0BI,eADO;EAEvCF,OAAO,EAAEJ;AAF8B,CAAjB,CAAxB,C,CAKA;;;AACA,MAAMO,SAAS,GAAIC,IAAD,KAAW;EAC3BP,IAAI,EAAEL,YAAY,CAACM,YAAb,CAA0BO,gBADL;EAE3BL,OAAO,EAAEI;AAFkB,CAAX,CAAlB,C,CAKA;AACA;;;AACA,MAAME,qBAAqB,GAAIV,UAAD,IAAgB,CAACW,QAAD,EAAWC,QAAX,KAAwB;EACpE,MAAMC,IAAI,GAAGD,QAAQ,GAAGV,YAAX,CAAwBY,WAAxB,CAAoCd,UAApC,CAAb;;EACA,IAAIa,IAAI,IAAIA,IAAI,CAACE,MAAL,KAAgBlB,WAAW,CAACmB,KAAxC,EAA+C;IAC7C;IACA;EACD;;EAED,IAAIH,IAAI,IAAIA,IAAI,CAACE,MAAL,KAAgBlB,WAAW,CAACoB,OAAxC,EAAiD;IAC/C;IACA;EACD;;EAEDN,QAAQ,CAACZ,cAAc,CAACC,UAAD,CAAf,CAAR,CAZoE,CAY9B;;EACtCF,iBAAiB,CAACE,UAAD,CAAjB,CACGkB,IADH,CACQC,QAAQ,IAAIR,QAAQ,CAACJ,SAAS,CAACY,QAAQ,CAACX,IAAV,CAAV,CAD5B,EACwD;EADxD,CAEGY,KAFH,CAESC,KAAK,IAAI;IACdC,OAAO,CAACC,GAAR,CAAYF,KAAZ;IACAV,QAAQ,CAACN,eAAe,CAACL,UAAD,CAAhB,CAAR,CAFc,CAEyB;EACxC,CALH;AAMD,CAnBD;;AAsBA,SAASU,qBAAT"},"metadata":{},"sourceType":"module"}